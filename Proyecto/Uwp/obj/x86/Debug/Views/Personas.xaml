<Page
    x:Class="Uwp.Views.Personas"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Uwp.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodel="using:Uwp.ViewModels"
    xmlns:converters="using:Uwp.Parsers"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">


    <Page.DataContext>
        <viewmodel:PersonaViewModel/>
    </Page.DataContext>

    <Page.Resources>
        <converters:ParseData x:Key="parseConverter"/>
    </Page.Resources>

    <Grid x:ConnectionId='2' x:Name="GridPrincipal">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.04*"/>
            <ColumnDefinition Width="0.05*"/>
        </Grid.ColumnDefinitions>

        <RelativePanel Grid.Row="0" Grid.Column="0">

        <StackPanel x:ConnectionId='15' Name="Cabecera" RelativePanel.AlignTopWithPanel="True" RelativePanel.AlignLeftWithPanel="True" Orientation="Horizontal" MaxWidth="500">

        <TextBox x:ConnectionId='18' MinWidth="300" x:Name="busqueda" Text="{Binding Path=NombreBusqueda, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></TextBox>

        <AppBarButton x:ConnectionId='19'  Name="btnSearch" Icon="Find"  Command="{Binding Path=SearchComand}"/>

        <AppBarButton x:ConnectionId='20'   Name="btnDelete" Icon="Delete" Command="{Binding Path=DeleteComand}"/>

        <AppBarButton x:ConnectionId='21'   Name="btnAdd" Icon="Add" Command="{Binding Path=AddComand}"/>


        </StackPanel>


    <ListView x:ConnectionId='16' x:Name="personList" RelativePanel.Below="Cabecera" Margin="0,10,0,0" ItemsSource="{Binding Path=PersonListFiltrada, Mode=OneWay}"  SelectedItem="{Binding Path=SelectedPerson, Mode=TwoWay}">

        <ListView.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding name}"></TextBlock>
                    <TextBlock Margin="5,0,0,0" Text="{Binding lastName}"></TextBlock>
                </StackPanel>
            </DataTemplate>
        </ListView.ItemTemplate>

    </ListView>
        
    </RelativePanel>

        <StackPanel x:ConnectionId='3' VerticalAlignment="Top" Orientation="Vertical" x:Name="Formulario" Grid.Column="1" Grid.Row="0">

            <TextBlock x:ConnectionId='4' x:Name="tbName"  HorizontalAlignment="Left" Text="Name" Margin="5"/>
            <TextBox x:ConnectionId='5' Name="tbxName"  Text="{Binding Path=SelectedPerson.name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

            <TextBlock x:ConnectionId='6' x:Name="tbLastName"  HorizontalAlignment="Left" Text="LastName"   Margin="5"/>
            <TextBox x:ConnectionId='7' Name="tbxLastname"  Text="{Binding Path=SelectedPerson.lastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  Margin="5"/>

            <TextBlock x:ConnectionId='8' x:Name="tbBirthDate"  HorizontalAlignment="Left" Text="Birth Date" Margin="5"/>
            <TextBox x:ConnectionId='9' Name="tbxBirthDate"  Text="{Binding Path=SelectedPerson.birthDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource parseConverter}}" Margin="5"/>

            <TextBlock x:ConnectionId='10' x:Name="tbPhoneNumber"  HorizontalAlignment="Left" Text="Phone number"  Margin="5"/>
            <TextBox x:ConnectionId='11' Name="tbxPhoneNumber"  Text="{Binding Path=SelectedPerson.phoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

            <TextBlock x:ConnectionId='12' x:Name="tbAddress"  HorizontalAlignment="Left" Text="Address"   Margin="5"/>
            <TextBox x:ConnectionId='13' Name="tbxAddress"  Text="{Binding Path=SelectedPerson.address, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"   Margin="5"/>

            <ComboBox x:ConnectionId='14' 
                Name="departamentos"
                DisplayMemberPath="name"
                SelectedValue="{Binding Path=SelectedPerson.iddepartamento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                SelectedValuePath="id"
                Margin="5" 
                Grid.Column="1"
                Grid.Row="5" 
                SelectedIndex="{Binding Path=SelectedPerson.iddepartamento}"
                ItemsSource="{Binding Path=ListDepartaments}"     
            />

            <AppBarButton Icon="Save" Command="{Binding Path=SaveComand}"/>
            
        </StackPanel> 
             
    </Grid>

</Page>


